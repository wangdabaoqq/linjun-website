# 账号模型规则

> 适用版本：v1.0.0+
> 更新时间：2024-02-13

## 概述

账号模型规则（Account Model Rules）允许你为每个 OAuth 账号指定可以使用的模型列表。这个功能可以用来：

- 限制特定账号只能访问某些模型
- 避免账号使用不支持的模型导致请求失败
- 为不同账号分配不同的模型权限

## 打开配置

1. 进入 **Providers** 页面
2. 在已添加的 OAuth 账号旁边，点击模型规则图标（通常显示为齿轮或过滤器图标）
3. 打开 **Account Model Rules** 弹窗

## 配置方式

### 从模型列表选择

弹窗会自动加载当前代理可用的模型列表（按提供商过滤）。点击任意模型即可添加到规则中。

### 手动输入模式

在搜索框中输入模型名称或模式，按回车或点击添加按钮。

## 模式匹配语法

账号模型规则支持通配符模式匹配：

| 模式 | 说明 | 示例 |
|------|------|------|
| 精确匹配 | 完整的模型名称 | `gemini-2.5-pro` |
| 前缀匹配 | 以 `*` 结尾 | `gemini-2.5-*` 匹配所有 gemini-2.5 开头的模型 |
| 后缀匹配 | 以 `*` 开头 | `*-preview` 匹配所有 preview 结尾的模型 |
| 包含匹配 | 两端都有 `*` | `*flash*` 匹配所有包含 flash 的模型 |

## 配置示例

### 只允许使用 Pro 模型

```text
gemini-2.5-pro
gemini-2.0-pro
claude-3-5-sonnet*
```

### 允许所有 Flash 模型

```text
*flash*
```

### 排除预览版模型（只允许正式版）

```text
gemini-2.5-pro
gemini-2.0-flash
claude-3-5-sonnet-20241022
```

## Source Key

对于某些提供商（如 Gemini），可能有多个来源选项：

| 提供商 | Source 选项 |
|--------|-------------|
| Gemini | `gemini-cli`, `vertex`, `aistudio` |
| Claude | `claude` |
| Codex | `codex` |
| Copilot | `copilot` |
| Kiro | `kiro` |

选择正确的 Source Key 以确保规则应用到正确的上游服务。

## 保存规则

1. 添加完所有需要的模型模式
2. 确保至少有一个模式（不能为空）
3. 点击 **Save** 按钮保存

保存后，该账号的请求将只能使用匹配规则的模型。

## 删除规则

如果要移除某个模式，点击模式旁边的 X 按钮。

如果要清除所有规则（允许访问所有模型），删除所有模式后保存。

## 常见问题

### 规则不生效

- 确保代理服务正在运行
- 检查 Source Key 是否正确
- 尝试重新保存规则

### 请求被拒绝

如果请求的模型不在规则列表中，请求会被代理拒绝。检查规则是否正确包含了需要的模型。

### 模型列表为空

- 确保代理服务正在运行
- 点击刷新按钮重新加载
- 检查网络连接

## 下一步

- [提供商概览](./overview)
- [OAuth 登录](./oauth-login)
